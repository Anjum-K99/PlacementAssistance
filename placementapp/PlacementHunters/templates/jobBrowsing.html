{% extends 'layout.html' %}

{% block cust_stylesheet %}
{% endblock %}

{% block navbar1 %}
{% include 'navbar1.html' %}
{% endblock navbar1 %}

{% block navbar2 %}
{% include 'navbar2.html' %}
{% endblock navbar2 %}

{% block content %}
  <div class="container-fluid mt-5">
    <div class="row">
      <div class="col-md-3 fixed-top bg-dark">
        <!--the filter options sidebar will go here-->
      </div>
      <div class="col-md">
        <div class="container" id="recommended_jobs">
        </div>
      </div>
    </div>
  </div>
{% endblock content %}

{% block cust_scripts %}
  <script>
    function test_func(percent, jobs) {
      console.log(percent);
      console.log(jobs);
      var y = window.location.href;
      var x = y.substr(30)
      console.log(x)
      const container = document.getElementById('recommended_jobs');
      var i, j,k;
      var content = '';

      console.log("percentage length", percent.length)
      if (percent.length!=0)
        { k=0;
          for (i = 0; i < percent.length; i++) {
          
          console.log("outer loop", i)
          var job_id = percent[i][0];
          for (j = 0; j < jobs.length; j++) {
            console.log("inner loop", j);
            console.log(x);
            if(x!='all')
              {
                if (jobs[j][5] == job_id && jobs[j][4]==x) {
                  console.log("hii")
                  var job_descrip = jobs[j][0]
                  var package = jobs[j][1]
                  var num_open = jobs[j][2]
                  var company_id = jobs[j][3]
                  var percentage = percent[i][1]
                  var job_loc = jobs[j][4]
                  if(k%3==0) content+=`<div class="row">`;
                  content += `<div class="col-md card card-cascade wider m-3">
                      <!-- Card image -->
                      <div class="view view-cascade overlay">
                        <img class="card-img-top" src="https://mdbootstrap.com/img/Photos/Others/photo6.jpg"
                          alt="Card image cap">
                        <a href="#!">
                          <div class="mask rgba-white-slight"></div>
                        </a>
                      </div>

                      <!-- Card content -->
                      <div class="card-body card-body-cascade text-center">
                        <!-- Title -->
                        <h4 class="card-title"><strong>${job_descrip}</strong></h4>
                        <!-- Subtitle -->
                        <h5 class="blue-text pb-2"><strong>Package:${package}</strong></h5>
                        <h5 class="blue-text pb-2"><strong>Number of openings:${num_open}</strong></h5>
                        <h5 class="blue-text pb-2"><strong>Location:${job_loc}</strong></h5>
                        <h5 class="blue-text pb-2 text-muted"><strong>${percentage}% match!</strong></h5>
                      

                        <!-- Text -->
                        <p class="card-text">Sed ut perspiciatis unde omnis iste natus sit voluptatem accusantium doloremque
                          laudantium, totam rem aperiam. </p>
                          <button class="btn purchase-btn"><a href="jobinfo/${job_id}">know more</a></button>
                      </div>
                      </div>`;
                  if(k%3==2) content+=`</div>`;
                  console.log('end of outer',i);
                  k=k+1;
                  console.log("k:");
                  console.log(k);
                  break;}}
            else
              {console.log(jobs[j][4])
                if (jobs[j][5] == job_id) {
                  var job_descrip = jobs[j][0]
                  var package = jobs[j][1]
                  var num_open = jobs[j][2]
                  var company_id = jobs[j][3]
                  var percentage = percent[i][1]
                  var job_loc = jobs[j][4]
                  if(i%3==0) content+=`<div class="row">`;
                  content += `<div class="col-md card card-cascade wider m-3">
                      <!-- Card image -->
                      <div class="view view-cascade overlay">
                        <img class="card-img-top" src="https://mdbootstrap.com/img/Photos/Others/photo6.jpg"
                          alt="Card image cap">
                        <a href="#!">
                          <div class="mask rgba-white-slight"></div>
                        </a>
                      </div>

                      <!-- Card content -->
                      <div class="card-body card-body-cascade text-center">
                        <!-- Title -->
                        <h4 class="card-title"><strong>${job_descrip}</strong></h4>
                        <!-- Subtitle -->
                        <h5 class="blue-text pb-2"><strong>Package:${package}</strong></h5>
                        <h5 class="blue-text pb-2"><strong>Number of openings:${num_open}</strong></h5>
                        <h5 class="blue-text pb-2"><strong>Location:${job_loc}</strong></h5>
                        <h5 class="blue-text pb-2 text-muted"><strong>${percentage}% match!</strong></h5>
                      

                        <!-- Text -->
                        <p class="card-text">Sed ut perspiciatis unde omnis iste natus sit voluptatem accusantium doloremque
                          laudantium, totam rem aperiam. </p>
                          <button class="btn purchase-btn"><a href="jobinfo/${job_id}">know more</a></button>
                      </div>
                      </div>`;
                  if(i%3==2) content+=`</div>`;
                  console.log('end of outer',i);
                  break;}}
          }
        }
        container.innerHTML += content;
        }
        else{
          i=0;
          for (j = 0; j < jobs.length; j++) {
            
            if(x!='all')
              {
                if (jobs[j][4]==x) {
                  console.log("hii")
                  var job_descrip = jobs[j][0]
                  var package = jobs[j][1]
                  var num_open = jobs[j][2]
                  var company_id = jobs[j][3]
                  var job_loc = jobs[j][4]
                  if(i%3==0) content+=`<div class="row">`;
                  content += `<div class="col-md card card-cascade wider m-3">
                      <!-- Card image -->
                      <div class="view view-cascade overlay">
                        <img class="card-img-top" src="https://mdbootstrap.com/img/Photos/Others/photo6.jpg"
                          alt="Card image cap">
                        <a href="#!">
                          <div class="mask rgba-white-slight"></div>
                        </a>
                      </div>

                      <!-- Card content -->
                      <div class="card-body card-body-cascade text-center">
                        <!-- Title -->
                        <h4 class="card-title"><strong>${job_descrip}</strong></h4>
                        <!-- Subtitle -->
                        <h5 class="blue-text pb-2"><strong>Package:${package}</strong></h5>
                        <h5 class="blue-text pb-2"><strong>Number of openings:${num_open}</strong></h5>
                        <h5 class="blue-text pb-2"><strong>Location:${job_loc}</strong></h5>
                      

                        <!-- Text -->
                        <p class="card-text">Sed ut perspiciatis unde omnis iste natus sit voluptatem accusantium doloremque
                          laudantium, totam rem aperiam. </p>
                          <button class="btn purchase-btn"><a href="jobinfo/${jobs[j][5]}">know more</a></button>
                      </div>
                      </div>`;
                  if(i%3==2) content+=`</div>`;
                  i=i+1;
                  console.log("i:");
                  console.log(i);
                  }}
            else
              {
                  var job_descrip = jobs[j][0]
                  var package = jobs[j][1]
                  var num_open = jobs[j][2]
                  var company_id = jobs[j][3]
                  var job_loc = jobs[j][4]
                  if(j%3==0) content+=`<div class="row">`;
                  content += `<div class="col-md card card-cascade wider m-3">
                      <!-- Card image -->
                      <div class="view view-cascade overlay">
                        <img class="card-img-top" src="https://mdbootstrap.com/img/Photos/Others/photo6.jpg"
                          alt="Card image cap">
                        <a href="#!">
                          <div class="mask rgba-white-slight"></div>
                        </a>
                      </div>

                      <!-- Card content -->
                      <div class="card-body card-body-cascade text-center">
                        <!-- Title -->
                        <h4 class="card-title"><strong>${job_descrip}</strong></h4>
                        <!-- Subtitle -->
                        <h5 class="blue-text pb-2"><strong>Package:${package}</strong></h5>
                        <h5 class="blue-text pb-2"><strong>Number of openings:${num_open}</strong></h5>
                        <h5 class="blue-text pb-2"><strong>Location:${job_loc}</strong></h5>
                      

                        <!-- Text -->
                        <p class="card-text">Sed ut perspiciatis unde omnis iste natus sit voluptatem accusantium doloremque
                          laudantium, totam rem aperiam. </p>
                          <button class="btn purchase-btn"><a href="jobinfo/${jobs[j][5]}">know more</a></button>
                      </div>
                      </div>`;
                  if(j%3==2) content+=`</div>`;
      }
      
    }
    container.innerHTML += content;
  }
    }
    test_func({{ percent| safe }}, {{ jobs| safe }})

  </script>
{% endblock cust_scripts %}